function e(e){return document.querySelector(e)}let t,o,r={};const n=document.querySelector("map-def");function a(e,t){let o,r;switch(t[0]){case"rasters":case"r":e.rasters=[],o=t[1].split(","),o.forEach(t=>{const o=-1===t.indexOf("{")?t:JSON.parse(decodeURIComponent(t));e.rasters.push(o)});break;case"lat":e.lat=parseFloat(t[1]);break;case"lon":e.lon=parseFloat(t[1]);break;case"zoom":case"z":e.zoom=parseFloat(t[1]);break;case"components":case"c":e.components=t[1].split(",");break;case"vectors":case"v":t[1]=t[1].replace(/\s+/g," "),r=-1!=t[1].indexOf("[")?JSON.parse(decodeURIComponent(t[1])):[t[1]],e.vectors=[],r.forEach(t=>{let o;"string"==typeof t?o={url:t,id:t}:(o={url:t.url},o.id=t.id||t.url,t.group&&(o.group=t.group),t.attribution&&(o.attribution=t.attribution),t.style&&(o.style=t.style),t.format&&(o.format=t.format),t.strategy&&(o.strategy=t.strategy),t.noDisplay&&(o.noDisplay=t.noDisplay)),e.vectors.push(o)});break;default:e[t[0]]=t[1]}return e}function s(e){t=e}n?r=function(e){let t={};const o=e.children;for(let e=0;e<o.length;e++){t=a(t,[o[e].localName,o[e].innerHTML])}return t}(n):window.location.search&&(r=function(){let e,t={};return window.location.search.substring(1).split("&").forEach(o=>{e=o.split("="),t=a(t,e)}),t}()),r.lat&&r.lon&&(r.center={lat:r.lat,lon:r.lon}),r&&r.mapdef&&(o=r.mapdef),o||s(r||{projCode:"EPSG:4326"});var c={init:function(){return new Promise((e,r)=>{o?fetch(decodeURIComponent(o)).then(e=>e.json()).then(t=>{s(t),e(t)}).catch(()=>r()):e(t)})},get:function(){return t},set:s};export{e as $,c as m};
